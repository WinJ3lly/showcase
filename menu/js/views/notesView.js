define(["./notesItemView","../extensions/save2Word","../extensions/customScrollbar"],function(t,n,o){class e extends Backbone.View{events(){return{"click .js-notes-handle":"onHandleClick","click .js-notes-controls-add":"onControlsAddClick","click .js-notes-controls-scroll":"onControlsScrollClick","click .js-notes-controls-save":"onControlsSaveClick"}}initialize(){this.render(),this.setupEventListeners()}setupEventListeners(){this.listenTo(this.model,{"change:_isActive":this.onActiveChange}),this.listenTo(this.model.get("_parent"),"change:_itemActive",this.onActiveSlideChange)}onActiveSlideChange(e,t){this.$(".js-notes-controls-add").toggleClass("is-locked",Boolean(t.get("_note")))}onActiveChange(e,t){this.$el.toggleClass("is-active",t)}onHandleClick(){this.model.toggle()}onControlsAddClick(){var e=this.model.get("_parent").getActiveContent(),e=this.model.createItemModel(e,"");this.renderNoteItem(e),e.focus(),this.$(".js-notes-controls-add").toggleClass("is-locked",!0)}renderNoteItem(e){e.get("_isRendered")||(e.set("_isRendered",!0),e=new t({model:e}),this.$(".js-notes-items-container").append(e.$el))}render(){var e=this.model.toJSON(),t=Handlebars.templates["hm-notes"];this.$el.html(new Handlebars.SafeString(t(e)).string),this.model.get("_items").each(e=>{this.renderNoteItem(e)});try{var s=this.model.get("_parent").getActiveContent();this.$(".js-notes-controls-add").toggleClass("is-locked",Boolean(s.get("_note")))}catch(e){}new o(this.$el)}onControlsSaveClick(){this.model.saveToCookies();var e=this.model.get("saveFilename");let s=Handlebars.templates["hm-wordItem"];n.begin(e),this.model.get("_items").each(e=>{var t=e.get("title").trim(),e=(e=e.get("body").trim()).replace(/\n/g,"<br/>"),t=new Handlebars.SafeString(s({title:t,body:e||"&nbsp;"})).string;n.write($(t))}),n.end()}}return e});